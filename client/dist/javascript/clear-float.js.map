{"version":3,"sources":["src/javascript/clear-float.js"],"names":["plugin","init","editor","clear_html","clear_html_no_semicolon","replace","clear_placeholder","tinymce","Env","transparentSrc","ui","registry","addButton","icon","tooltip","onAction","execCommand","on","event","re_clear_html","re_clear_html_no_semicolon","content","RegExp","get","image","string","indexOf","getMetadata","name","url","PluginManager","add"],"mappings":"aACA,IAAAA,OAAA,CACAC,KAAIC,QACJ,IAHEC,WAAW,4BACbC,wBAAAD,WAAAE,QAAA,IAAA,EAAA,EAKAC,kBAHY,aAASC,QAAAC,IAAAC,eAAA,mHAyCrB,OArCAP,OAAAQ,GAAAC,SAHYC,UAAgB,cAAG,CAI/BC,KAAA,aACAC,QAAA,cACAC,SAEA,WACAb,OAAAc,YAHA,mBAAA,CAAA,EAA6BV,iBAAA,CAI7B,CAHA,CAAA,EAIAJ,OAAAe,GAAA,mBAAA,SAAAC,OACA,IACAC,cAFAC,2BACAF,MAHAG,UAIAF,cAHA,IAAAG,OAAyBnB,WAAA,GAAA,EACzBiB,2BAAA,IAAAE,OAAAlB,wBAAA,GAAA,EAIAc,MAAAG,QAHmBH,MAAGG,QAAAhB,QAASc,cAAAb,iBAAA,EAS/BY,MAAAG,QAAAH,MAAAG,QAAAhB,QAAAe,2BAAAd,iBAAA,EAKAY,MAAAG,QAHgBH,MAAKG,QAAMhB,QAAU,oCAAAC,iBAAA,EAKrC,CAAA,EACAJ,OAAAe,GAAA,cAAA,SAAAC,OAFAA,MAAAK,MAIAL,MAAAG,QAAAH,MAAAG,QAAAhB,QAAA,cAAA,SAAAmB,OACA,IAAAC,OAIA,OAFAA,OADA,CAAA,IAAAD,MAAAE,QAAA,yBAAA,EACAvB,WAEAsB,SAAAD,KACA,CAAA,EAEA,CAAA,EACA,CACAG,cACA,MAAA,CAFAC,KAAA,eAIAC,IAAA,0DACA,CACA,CACA,CAFA,CAIA,EAGAtB,QAAAuB,cAHAC,IAAA,cAAA7B,QAAAF,OAAAC,KAAAC,MAAA,CAAA,CAIA,C","file":"clear-float.js","sourcesContent":["( function() {\n\n    const plugin = {\n        init(editor) {\n            const clear_html = '<br style=\"clear: both;\">',\n                clear_html_no_semicolon = clear_html.replace( ';', '' ),\n                clear_title = 'Clear float',\n                clear_placeholder = '<img ' +\n                    'src=\"' + tinymce.Env.transparentSrc + '\" ' +\n                    'class=\"mce-tinymce-clear-float\" ' +\n                    'alt=\"\" ' +\n                    'title=\"' + clear_title + '\" ' +\n                    'data-mce-resize=\"false\" ' +\n                    'data-mce-placeholder=\"1\" ' +\n                    '/>';\n\n            editor.ui.registry.addButton( 'clear-float', {\n                icon: 'page-break',\n                tooltip: 'Clear float',\n                onAction: insertClearFloat\n            } );\n\n            function insertClearFloat() {\n                editor.execCommand( 'mceInsertContent', false, clear_placeholder );\n            }\n\n            editor.on( 'BeforeSetContent', function( event ) {\n                if ( event.content ) {\n                    var re_clear_html = new RegExp( clear_html, 'g' );\n                    var re_clear_html_no_semicolon = new RegExp( clear_html_no_semicolon, 'g' );\n                    event.content = event.content.replace( re_clear_html, clear_placeholder );\n\n                    /**\n                     * Under certain circumstances, TinyMCE will strip the semicolon from `<br style=\"clear: both;\">.\n                     * Also replace this.\n                     */\n                    event.content = event.content.replace( re_clear_html_no_semicolon, clear_placeholder );\n                    /**\n                     * Replace `<div style=\"clear: (left|right|both);\"></div>` with placeholder too.\n                     * This HTML markup has been used until version 1.1.\n                     */\n                    event.content = event.content.replace( /<div style=\"clear:(.+?)\"><\\/div>/g, clear_placeholder );\n                }\n            } );\n\n            editor.on( 'PostProcess', function( event ) {\n                if ( event.get ) {\n                    event.content = event.content.replace( /<img[^>]+>/g, function( image ) {\n                        var string;\n\n                        if ( image.indexOf( 'mce-tinymce-clear-float' ) !== -1 ) {\n                            string = clear_html;\n                        }\n                        return string || image;\n                    } );\n                }\n            } );\n\n            return {\n                getMetadata() {\n                    return {\n                        name: 'Clear Floats',\n                        url: 'https://github.com/xini/silverstripe-tinymce-clearfloats',\n                    };\n                }\n            };\n        }\n    };\n\n    // Adds the plugin class to the list of available TinyMCE plugins\n    tinymce.PluginManager.add('clear-float', (editor) => plugin.init(editor));\n} )();\n"]}